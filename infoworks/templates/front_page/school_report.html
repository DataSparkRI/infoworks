{% extends "front_page/base.html" %}{% load staticfiles %}{% load config %}{% load humanize %}{% load cache %}

{% block title %}
{{school.school_name}} - School and District data - RIDE InfoWorks
{% endblock %}

{% block body %}
     {% cache 35000 school request.path school.id request.user.is_staff %}
      <nav class="side-menu">
        <ul>
          <li class="hidden active">
              <a class="page-scroll" href="#page-top"></a>
          </li>
          <li>
              <a href="#home" class="page-scroll">
                <span class="menu-title">Home</span>
                <span class='dot'></span>
              </a>
          </li>
          {% for i in school.indicatorset %}
          <li>
              <a href="#{{i.order}}" class="page-scroll">
                <span class="menu-title">{{i.title}}</span>
                <span class="dot"></span>
              </a>
          </li>
          {% endfor %}
        </ul>
      </nav>
      
      <div class="container-fluid">
        <!-- Start: Header -->
        <div class="row hero-header" id="home">
          <div class="col-md-7">
            <h1>{{school.school_name}}{% if request.user.is_active and request.user.is_staff %} <a href="/admin/data/school/{{school.id}}" target="_blank"><i class="fa fa-pencil"></i></a>{% endif %}</h1>
            <h3>{{school.description |safe }}</h3>
            {% if school.street %}<h4><i class="fa fa-map-marker"></i> {{school.street}} {{school.city}} {{school.state}} {{school.zip}}</h4>{% endif %}
            {% if school.phone %}<h4><i class="fa fa-phone"></i> {{school.phone}}</h4>{% endif %}
            {% if school.website %}<h4 class='header-link'><i class="fa fa-globe"></i> <a href='{{school.website}}' target="_blank">{{school.website}}</a></h4>{% endif %}
            {% if school.principal %}<h4><i class="fa fa-user"></i> Principal {{school.principal}}</h4>{% endif %}
            <h4><i class="fa fa-graduation-cap"></i> Grade:</h4>
            <p class="btn btn-red" style="cursor: text;" {% if school.grade_pk == False %}disabled="disabled"{% endif %}>PK</p>
            <p class="btn btn-red" style="cursor: text;" {% if school.grade_k == False %}disabled="disabled"{% endif %}>K</p>
            <p class="btn btn-red" style="cursor: text;" {% if school.grade_1 == False %}disabled="disabled"{% endif %}>1</p>
            <p class="btn btn-red" style="cursor: text;" {% if school.grade_2 == False %}disabled="disabled"{% endif %}>2</p>
            <p class="btn btn-red" style="cursor: text;" {% if school.grade_3 == False %}disabled="disabled"{% endif %}>3</p>
            <p class="btn btn-red" style="cursor: text;" {% if school.grade_4 == False %}disabled="disabled"{% endif %}>4</p>
            <p class="btn btn-red" style="cursor: text;" {% if school.grade_5 == False %}disabled="disabled"{% endif %}>5</p>
            <p class="btn btn-red" style="cursor: text;" {% if school.grade_6 == False %}disabled="disabled"{% endif %}>6</p>
            <p class="btn btn-red" style="cursor: text;" {% if school.grade_7 == False %}disabled="disabled"{% endif %}>7</p>
            <p class="btn btn-red" style="cursor: text;" {% if school.grade_8 == False %}disabled="disabled"{% endif %}>8</p>
            <p class="btn btn-red" style="cursor: text;" {% if school.grade_9 == False %}disabled="disabled"{% endif %}>9</p>
            <p class="btn btn-red" style="cursor: text;" {% if school.grade_10 == False %}disabled="disabled"{% endif %}>10</p>
            <p class="btn btn-red" style="cursor: text;" {% if school.grade_11 == False %}disabled="disabled"{% endif %}>11</p>
            <p class="btn btn-red" style="cursor: text;" {% if school.grade_12 == False %}disabled="disabled"{% endif %}>12</p>

            <h4></h4>

            {% if school.number_of_student %}<p class="btn btn-red" style="cursor: text;">{{school.number_of_student|intcomma}} Students</p>{% endif %}
			      {% if school.number_of_teacher %}<p class="btn btn-red" style="cursor: text;">{{school.number_of_teacher|intcomma}} Teachers</p>{% endif %}

            <h5></h5>
            <a class="btn btn-primary" role="button" href="/school/{{school.slug}}/history">Historical Data</a>


          </div>
          <div class="col-md-5 hidden-xs">
            <img src="{% static "img/rocket.png" %}" class="rocket animated bounce">
          </div>
        </div>
        <!-- End: Header -->
      </div>
      
      <!-- Start: Schedule -->
      {% for i in school.indicatorset %}
      <section class="container">
        <div class="row me-row schedule" id="{{i.order}}">
          <h2 class="row-title content-ct">{{i.title}}{% if request.user.is_active and request.user.is_staff %} <a href="/admin/data/schoolindicatorset/{{i.id}}" target="_blank"><i class="fa fa-pencil"></i></a>{% endif %}</h2>
          <div class="col-md-12">
            <!-- Nav tabs -->
            <ul class="nav nav-tabs" role="tablist">
              {% for j in i.indicators %}
              {% if j.dataset or request.user.is_active and request.user.is_staff %}
              <li role="presentation" {% if forloop.first %}class="active"{% endif %}><a href="#indicator_{{j.id}}" aria-controls="home" role="tab" data-toggle="tab">{{j.title.title}}</a></li> {% endif %}
              {% endfor %}
            </ul>

            <!-- Tab panes -->
            <div class="tab-content">
              {% for j in i.indicators %}
              {% if j.dataset or request.user.is_active and request.user.is_staff %}
              <div role="tabpanel" class="tab-pane fade{% if forloop.first %} in active{% endif %}" id="indicator_{{j.id}}">
                <div class="row">
                  <div class="col-md-{% if 'indicator-col-md-left'|get_config %}{{'indicator-col-md-left'|get_config}}{% else %}4{% endif %}">
                    <div class="media">
                      {% if j.highchart %}<div id="highchart_{{j.id}}" style="min-width: 310px; height: 400px; max-width: 600px; margin: 0 auto"></div>{% endif %}
                      {% if request.user.is_active and request.user.is_staff %}
                      <div class="media-left">
                        <a href="/admin/data/schoolindicator/{{j.id}}">
                          <i class="fa fa-pencil"></i>
                        </a>
                      </div>
                      {% endif %}
                      <div class="media-body">
                        <h4 class="media-heading">{{j.short_title}}</h4>
                        {% if j.dataset %}<h3 class="text-right">{{j.dataset.0.school_year.school_year}}</h3>{% endif %}
                        {% if j.over_time %}<a href = "{% url 'school_overtime' school.slug %}?category={{j.title.title}}"><h3>Over Time Data</h3></a>{% endif %}
                        <p>{{j.description|safe}}</p>
                      </div>
                    </div>
                  </div>

                  <div class="col-md-{% if 'indicator-col-md-right'|get_config %}{{'indicator-col-md-right'|get_config}}{% else %}8{% endif %}">
                    <div class="media">
                      <div class="media-body">
                        
                        <table class="table table-hover">
                          <thead> <tr><th></th>
                                      {% for k in j.dataset.0.displaydata_x_display%}
                                      <th>{% if k.display_name %}{{k.display_name}}{% elif k.display.name %}{{k.display.name}}{% else %}{{k}}{% endif %}</th>
                                      {% endfor %}
                                  </tr>
                          </thead>
                          <tbody> 
                                  {% if j.dataset %}
                                  {% for indicatordata in j.dataset.0.displaydata %}
                                  <tr><th scope="row">{% if indicatordata.dimension_y.display_name %}{{indicatordata.dimension_y.display_name}}{% else %}{{indicatordata.dimension_y.display}}{% endif %}</th>	
										{% with indicatordata.dimension_y.display as data_name %}
										{% for k in j.dataset.0.displaydata_x_display %}
											{% if forloop.first %}
											{% elif forloop.counter == 2 %}
												{% get_school_history_value j data_name k.display.name as row %}
												<td>{{row.school_indicator_dataset.school_year.school_year}}</td>
												{% get_school_value j row.school_indicator_dataset.school_year.school_year data_name k.display.name as data%}
												<td>{% get_display data %}</td>
											{% else %}
												{% if k == 'Details' %}
													{% if indicatordata.dimension_y.detail %}<td>{% url 'school_detail' school.slug j.id row.school_indicator_dataset.school_year indicatordata.dimension_y.detail.slug as the_url %}{% if the_url %}<a href="{{the_url}}">{{indicatordata.dimension_y.detail}}</a>{% else %}{% endif %}</td>{% else %}<td></td>{% endif %}												{% else %}
											    	{% get_school_value j row.school_indicator_dataset.school_year.school_year data_name k.display.name as data%}
													<td>{% get_display data %}</td>
												{% endif %}
											{% endif %}
										{% endfor %}
										{% endwith %}
								  </tr>
                                  {% endfor %}
                                  {% endif %}
                          </tbody>
                        </table>
                        
                      </div>
                    </div>
                    
                  </div>
                </div>
              </div>
              {% endif %}
              {% endfor %}
            </div>
          </div>
        </div>
      </section>
      {% endfor %}
      <!-- End: Schedule -->
      {% endcache %}
{% endblock body %}

{% block javascript %}
{{block.super}}
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
{% for i in school.indicatorset %}{% for j in i.indicators %}
{% if j.highchart %}<script src="{% url 'highchart_js' 'school' j.id j.dataset.0.school_year.school_year j.highchart.slug j.highchart.detail_set.0.id %}?name=highchart_{{j.id}}" type='text/javascript'></script>{% endif %}
{% endfor %}{% endfor %}
{% endblock %}